<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOEFL Reading Mock Test</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            padding: 30px;
            margin: 20px 0;
        }
        
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        h1 {
            text-align: center;
            color: #2980b9;
        }
        
        .timer {
            background-color: #2c3e50;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            color: #856404;
        }
        
        .module-selection {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }
        
        .module-btn {
            padding: 15px 30px;
            font-size: 1.1em;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .module-btn:hover {
            background-color: #2980b9;
            transform: translateY(-2px);
        }
        
        .module-btn.active {
            background-color: #2c3e50;
        }
        
        .module-btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }
        
        .test-content {
            display: none;
        }
        
        .test-content.active {
            display: block;
        }
        
        .c-test {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
            border-left: 4px solid #3498db;
            font-size: 1.1em;
            line-height: 1.8;
        }
        
        .c-test p {
            margin: 0;
        }
        
        .c-blank {
            display: inline-block;
            position: relative;
            margin: 0 2px;
            vertical-align: bottom;
        }
        
        .c-blank input {
            border: none;
            background: transparent;
            text-align: center;
            font-size: 1em;
            text-transform: lowercase;
            outline: none;
            border-bottom: 2px solid #7f8c8d;
            padding: 0 2px;
            font-family: monospace;
            letter-spacing: 1px;
        }
        
        /* Dynamic width based on expected answer length */
        .c-blank[data-answer-length="1"] input { width: 20px; }
        .c-blank[data-answer-length="2"] input { width: 30px; }
        .c-blank[data-answer-length="3"] input { width: 40px; }
        .c-blank[data-answer-length="4"] input { width: 50px; }
        .c-blank[data-answer-length="5"] input { width: 60px; }
        .c-blank[data-answer-length="6"] input { width: 70px; }
        .c-blank[data-answer-length="7"] input { width: 80px; }
        .c-blank[data-answer-length="8"] input { width: 90px; }
        .c-blank[data-answer-length="9"] input { width: 100px; }
        
        .c-blank.correct input {
            border-bottom-color: #27ae60;
            color: #27ae60;
            font-weight: bold;
        }
        
        .c-blank.incorrect input {
            border-bottom-color: #e74c3c;
            color: #e74c3c;
        }
        
        .c-answer-hint {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.8em;
            color: #7f8c8d;
            white-space: nowrap;
            display: none;
        }
        
        .c-blank:hover .c-answer-hint {
            display: block;
        }
        
        .question {
            margin: 25px 0;
            padding: 20px;
            border-radius: 8px;
            background-color: #f8f9fa;
            border-left: 4px solid #95a5a6;
        }
        
        .question.mcq {
            border-left-color: #9b59b6;
        }
        
        .question-text {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        
        .options {
            display: grid;
            gap: 10px;
        }
        
        .option {
            padding: 12px 15px;
            background-color: white;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .option:hover {
            background-color: #f1f8ff;
            border-color: #3498db;
        }
        
        .option.selected {
            background-color: #d6eaf8;
            border-color: #3498db;
        }
        
        .option.correct {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        .option.incorrect {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        
        .reading-passage {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 25px;
            line-height: 1.7;
        }
        
        .writing-task {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 25px 0;
            border-left: 4px solid #e67e22;
        }
        
        .sentence-build {
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            margin: 15px 0;
            border: 1px solid #ddd;
        }
        
        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
            padding: 15px;
            background-color: #f1f8ff;
            border-radius: 5px;
            border: 1px dashed #3498db;
        }
        
        .word-option {
            padding: 8px 15px;
            background-color: white;
            border: 1px solid #3498db;
            border-radius: 20px;
            cursor: move;
            user-select: none;
            transition: all 0.2s;
        }
        
        .word-option:hover {
            background-color: #e8f4fc;
            transform: translateY(-2px);
        }
        
        .word-option.used {
            opacity: 0.5;
            text-decoration: line-through;
            cursor: not-allowed;
        }
        
        .sentence-area {
            min-height: 60px;
            padding: 15px;
            background-color: white;
            border: 2px dashed #95a5a6;
            border-radius: 5px;
            margin: 15px 0;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            align-items: center;
        }
        
        .sentence-area .word-option {
            margin: 2px;
        }
        
        .controls {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
        
        .btn {
            padding: 12px 25px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #2980b9;
        }
        
        .btn-submit {
            background-color: #27ae60;
        }
        
        .btn-submit:hover {
            background-color: #219653;
        }
        
        .btn-clear {
            background-color: #e74c3c;
        }
        
        .btn-clear:hover {
            background-color: #c0392b;
        }
        
        .results {
            display: none;
            background-color: #f8f9fa;
            padding: 25px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        .results.active {
            display: block;
        }
        
        .score-display {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
            color: #2c3e50;
        }
        
        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .score-item {
            background-color: white;
            padding: 15px;
            border-radius: 5px;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .correct-answer {
            color: #27ae60;
            font-weight: bold;
        }
        
        .incorrect-answer {
            color: #e74c3c;
            font-weight: bold;
        }
        
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #e8f4fc;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .container {
                padding: 15px;
            }
            
            .module-selection {
                flex-direction: column;
            }
            
            .controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .c-blank[data-answer-length="1"] input { width: 18px; }
            .c-blank[data-answer-length="2"] input { width: 25px; }
            .c-blank[data-answer-length="3"] input { width: 35px; }
            .c-blank[data-answer-length="4"] input { width: 45px; }
            .c-blank[data-answer-length="5"] input { width: 55px; }
            .c-blank[data-answer-length="6"] input { width: 65px; }
            .c-blank[data-answer-length="7"] input { width: 75px; }
            .c-blank[data-answer-length="8"] input { width: 85px; }
            .c-blank[data-answer-length="9"] input { width: 95px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>TOEFL iBT® Reading Mock Test</h1>
        
        <div class="timer" id="timer">
            Module Time: <span id="time">18:00</span>
        </div>
        
        <div class="warning">
            <strong>Instructions:</strong> This test contains two modules. Complete Module 1 first, then proceed to Module 2. You will have 18 minutes for each module. Do not return to Module 1 once you have started Module 2.
        </div>
        
        <div class="module-selection">
            <button class="module-btn active" id="btn-module1">Module 1</button>
            <button class="module-btn" id="btn-module2">Module 2</button>
        </div>
        
        <!-- MODULE 1 -->
        <div class="test-content active" id="module1">
            <h2>Module 1</h2>
            
            <div class="c-test">
                <p><strong>Fill in the missing letters in the paragraph. (Questions 1–10)</strong></p>
                <p>
                    The Great Wall of China is one of the most remarkable feats of ancient engineering. 
                    Stret<span class="c-blank" data-answer="ching" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    for thou<span class="c-blank" data-answer="sands" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    of kil<span class="c-blank" data-answer="ometers" data-answer-length="7"><input type="text" maxlength="7"></span>, 
                    it wa<span class="c-blank" data-answer="s" data-answer-length="1"><input type="text" maxlength="1"></span> 
                    built ov<span class="c-blank" data-answer="er" data-answer-length="2"><input type="text" maxlength="2"></span> 
                    many cen<span class="c-blank" data-answer="turies" data-answer-length="6"><input type="text" maxlength="6"></span> 
                    to pro<span class="c-blank" data-answer="tect" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    China fr<span class="c-blank" data-answer="om" data-answer-length="2"><input type="text" maxlength="2"></span> 
                    invasions fr<span class="c-blank" data-answer="om" data-answer-length="2"><input type="text" maxlength="2"></span> 
                    the north. De<span class="c-blank" data-answer="spite" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    its im<span class="c-blank" data-answer="mense" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    size, it wa<span class="c-blank" data-answer="s" data-answer-length="1"><input type="text" maxlength="1"></span> 
                    not a<span class="c-blank" data-answer="n" data-answer-length="1"><input type="text" maxlength="1"></span> 
                    unbre<span class="c-blank" data-answer="akable" data-answer-length="7"><input type="text" maxlength="7"></span> 
                    barrier bu<span class="c-blank" data-answer="t" data-answer-length="1"><input type="text" maxlength="1"></span> 
                    rather a sy<span class="c-blank" data-answer="stem" data-answer-length="4"><input type="text" maxlength="4"></span> 
                    of fortifications. To<span class="c-blank" data-answer="day" data-answer-length="3"><input type="text" maxlength="3"></span>, 
                    it i<span class="c-blank" data-answer="s" data-answer-length="1"><input type="text" maxlength="1"></span> 
                    a UNESCO World Heritage Site and a popular tourist destination.
                </p>
            </div>
            
            <div class="writing-task">
                <p><strong>Task 5: Build a Sentence (Questions 21-25)</strong></p>
                <p>Rearrange the words to form a grammatical sentence.</p>
                
                <div class="sentence-build">
                    <p><strong>21. I'm planning to go to the beach tomorrow.</strong></p>
                    <div class="word-bank" id="word-bank-21">
                        <div class="word-option" data-word="is">is</div>
                        <div class="word-option" data-word="time">time</div>
                        <div class="word-option" data-word="of">of</div>
                        <div class="word-option" data-word="year">year</div>
                        <div class="word-option" data-word="what">what</div>
                        <div class="word-option" data-word="the">the</div>
                        <div class="word-option" data-word="water">water</div>
                        <div class="word-option" data-word="this">this</div>
                        <div class="word-option" data-word="like">like</div>
                        <div class="word-option" data-word="temperature">temperature</div>
                    </div>
                    <div class="sentence-area" id="sentence-area-21"></div>
                    <button class="btn btn-clear" onclick="clearSentence(21)">Clear</button>
                </div>
                
                <div class="sentence-build">
                    <p><strong>22. I need to buy groceries today.</strong></p>
                    <div class="word-bank" id="word-bank-22">
                        <div class="word-option" data-word="list">list</div>
                        <div class="word-option" data-word="do">do</div>
                        <div class="word-option" data-word="a">a</div>
                        <div class="word-option" data-word="have">have</div>
                        <div class="word-option" data-word="shopping">shopping</div>
                        <div class="word-option" data-word="you">you</div>
                    </div>
                    <div class="sentence-area" id="sentence-area-22"></div>
                    <button class="btn btn-clear" onclick="clearSentence(22)">Clear</button>
                </div>
                
                <div class="sentence-build">
                    <p><strong>23. I'll be taking a cooking class this weekend.</strong></p>
                    <div class="word-bank" id="word-bank-23">
                        <div class="word-option" data-word="learn">learn</div>
                        <div class="word-option" data-word="what">what</div>
                        <div class="word-option" data-word="will">will</div>
                        <div class="word-option" data-word="you">you</div>
                        <div class="word-option" data-word="recipes">recipes</div>
                    </div>
                    <div class="sentence-area" id="sentence-area-23"></div>
                    <button class="btn btn-clear" onclick="clearSentence(23)">Clear</button>
                </div>
                
                <div class="sentence-build">
                    <p><strong>24. What did Maria ask you about the book you're reading?</strong></p>
                    <div class="word-bank" id="word-bank-24">
                        <div class="word-option" data-word="She">She</div>
                        <div class="word-option" data-word="she">she</div>
                        <div class="word-option" data-word="wanted">wanted</div>
                        <div class="word-option" data-word="a">a</div>
                        <div class="word-option" data-word="copy">copy</div>
                        <div class="word-option" data-word="buy">buy</div>
                        <div class="word-option" data-word="to">to</div>
                        <div class="word-option" data-word="know">know</div>
                        <div class="word-option" data-word="could">could</div>
                        <div class="word-option" data-word="where">where</div>
                    </div>
                    <div class="sentence-area" id="sentence-area-24"></div>
                    <button class="btn btn-clear" onclick="clearSentence(24)">Clear</button>
                </div>
                
                <div class="sentence-build">
                    <p><strong>25. How did you prepare for the exam?</strong></p>
                    <div class="word-bank" id="word-bank-25">
                        <div class="word-option" data-word="I">I</div>
                        <div class="word-option" data-word="used">used</div>
                        <div class="word-option" data-word="by">by</div>
                        <div class="word-option" data-word="the">the</div>
                        <div class="word-option" data-word="professor">professor</div>
                        <div class="word-option" data-word="that">that</div>
                        <div class="word-option" data-word="the">the</div>
                        <div class="word-option" data-word="study">study</div>
                        <div class="word-option" data-word="guide">guide</div>
                        <div class="word-option" data-word="was">was</div>
                        <div class="word-option" data-word="provided">provided</div>
                        <div class="word-option" data-word="it">it</div>
                    </div>
                    <div class="sentence-area" id="sentence-area-25"></div>
                    <button class="btn btn-clear" onclick="clearSentence(25)">Clear</button>
                </div>
            </div>
            
            <div class="reading-passage">
                <p><strong>Read an email notification.</strong></p>
                <p><em>To: allstudents@campus.edu<br>
                From: library@campus.edu<br>
                Date: March 12, 2026<br>
                Subject: Extended Hours During Finals Week</em></p>
                
                <p>Dear Students,</p>
                
                <p>To support your studies during finals week, the campus library will extend its operating hours. From Monday, March 20, through Friday, March 24, the library will remain open until 2:00 AM. Regular hours will resume on Saturday, March 25.</p>
                
                <p>Please note that the 24-hour study rooms on the second floor will continue to be available as usual. We wish you the best of luck on your exams!</p>
                
                <p>Sincerely,<br>
                Campus Library Administration</p>
            </div>
            
            <div class="question mcq" data-correct="B">
                <div class="question-text">26. What is the main purpose of this email?</div>
                <div class="options">
                    <div class="option" data-value="A">To announce a new library location</div>
                    <div class="option" data-value="B">To inform students of longer library hours</div>
                    <div class="option" data-value="C">To warn students about a library closure</div>
                    <div class="option" data-value="D">To promote a new study room service</div>
                </div>
            </div>
            
            <div class="question mcq" data-correct="B">
                <div class="question-text">27. When will the extended hours end?</div>
                <div class="options">
                    <div class="option" data-value="A">March 20</div>
                    <div class="option" data-value="B">March 24</div>
                    <div class="option" data-value="C">March 25</div>
                    <div class="option" data-value="D">March 30</div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn btn-submit" id="submit-module1">Submit Module 1</button>
            </div>
        </div>
        
        <!-- MODULE 2 -->
        <div class="test-content" id="module2">
            <h2>Module 2</h2>
            
            <div class="c-test">
                <p><strong>Fill in the missing letters in the paragraph. (Questions 1–10)</strong></p>
                <p>
                    Climate change refers to significant changes in global temperatures and weather pat
                    <span class="c-blank" data-answer="terns" data-answer-length="6"><input type="text" maxlength="6"></span> 
                    over exte
                    <span class="c-blank" data-answer="nded" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    periods. Sc
                    <span class="c-blank" data-answer="ientists" data-answer-length="8"><input type="text" maxlength="8"></span> 
                    agree that human ac
                    <span class="c-blank" data-answer="tivities" data-answer-length="7"><input type="text" maxlength="7"></span>, 
                    such as burning fo
                    <span class="c-blank" data-answer="ssil" data-answer-length="4"><input type="text" maxlength="4"></span> 
                    fuels and defor
                    <span class="c-blank" data-answer="estation" data-answer-length="9"><input type="text" maxlength="9"></span>, 
                    are major contributors. Th
                    <span class="c-blank" data-answer="ese" data-answer-length="4"><input type="text" maxlength="4"></span> 
                    activities rel
                    <span class="c-blank" data-answer="ease" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    greenhouse gases, wh
                    <span class="c-blank" data-answer="ich" data-answer-length="4"><input type="text" maxlength="4"></span> 
                    trap heat in the atmosphere. Th
                    <span class="c-blank" data-answer="is" data-answer-length="2"><input type="text" maxlength="2"></span> 
                    leads to global warming, melting ice caps, and more extreme wea
                    <span class="c-blank" data-answer="ther" data-answer-length="5"><input type="text" maxlength="5"></span> 
                    events.
                </p>
            </div>
            
            <div class="writing-task">
                <p><strong>Task 5: Build a Sentence (Questions 21-25)</strong></p>
                <p>Rearrange the words to form a grammatical sentence.</p>
                
                <div class="sentence-build">
                    <p><strong>21. The tour guides were fantastic.</strong></p>
                    <div class="word-bank" id="word-bank-26">
                        <div class="word-option" data-word="who">who</div>
                        <div class="word-option" data-word="showed">showed</div>
                        <div class="word-option" data-word="us">us</div>
                        <div class="word-option" data-word="around">around</div>
                        <div class="word-option" data-word="the">the</div>
                        <div class="word-option" data-word="old">old</div>
                        <div class="word-option" data-word="city">city</div>
                        <div class="word-option" data-word="The">The</div>
                        <div class="word-option" data-word="tour">tour</div>
                        <div class="word-option" data-word="guides">guides</div>
                        <div class="word-option" data-word="were">were</div>
                        <div class="word-option" data-word="fantastic">fantastic</div>
                    </div>
                    <div class="sentence-area" id="sentence-area-26"></div>
                    <button class="btn btn-clear" onclick="clearSentence(26)">Clear</button>
                </div>
                
                <div class="sentence-build">
                    <p><strong>22. Do you know about her department move?</strong></p>
                    <div class="word-bank" id="word-bank-27">
                        <div class="word-option" data-word="Do">Do</div>
                        <div class="word-option" data-word="you">you</div>
                        <div class="word-option" data-word="know">know</div>
                        <div class="word-option" data-word="if">if</div>
                        <div class="word-option" data-word="she">she</div>
                        <div class="word-option" data-word="will">will</div>
                        <div class="word-option" data-word="be">be</div>
                        <div class="word-option" data-word="moving">moving</div>
                        <div class="word-option" data-word="to">to</div>
                        <div class="word-option" data-word="a">a</div>
                        <div class="word-option" data-word="different">different</div>
                        <div class="word-option" data-word="department">department</div>
                    </div>
                    <div class="sentence-area" id="sentence-area-27"></div>
                    <button class="btn btn-clear" onclick="clearSentence(27)">Clear</button>
                </div>
            </div>
            
            <div class="reading-passage">
                <p><strong>Read a memo.</strong></p>
                <p><em>To: All Staff<br>
                From: Management<br>
                Date: April 5, 2026<br>
                Subject: New Hybrid Work Policy</em></p>
                
                <p>Starting Monday, April 10, our company will implement a hybrid work policy. Employees may choose to work from home up to three days per week. On Tuesdays and Thursdays, all staff are expected to be in the office for team meetings and collaboration.</p>
                
                <p>Please discuss your preferred schedule with your supervisor by this Friday. We believe this change will improve work-life balance and productivity.</p>
            </div>
            
            <div class="question mcq" data-correct="B">
                <div class="question-text">28. What is the main purpose of this memo?</div>
                <div class="options">
                    <div class="option" data-value="A">To announce permanent remote work</div>
                    <div class="option" data-value="B">To introduce a new hybrid work schedule</div>
                    <div class="option" data-value="C">To cancel all in-office meetings</div>
                    <div class="option" data-value="D">To assign new supervisors</div>
                </div>
            </div>
            
            <div class="question mcq" data-correct="B">
                <div class="question-text">29. On which days are employees required to be in the office?</div>
                <div class="options">
                    <div class="option" data-value="A">Mondays and Wednesdays</div>
                    <div class="option" data-value="B">Tuesdays and Thursdays</div>
                    <div class="option" data-value="C">Fridays only</div>
                    <div class="option" data-value="D">Every day</div>
                </div>
            </div>
            
            <div class="controls">
                <button class="btn btn-submit" id="submit-module2">Submit Module 2</button>
            </div>
        </div>
        
        <!-- RESULTS SECTION -->
        <div class="results" id="results">
            <h2>Test Results</h2>
            <div class="score-display" id="final-score">Score: 0/35</div>
            
            <div class="score-breakdown" id="score-breakdown">
                <!-- Will be filled by JavaScript -->
            </div>
            
            <div class="feedback" id="feedback">
                <!-- Will be filled by JavaScript -->
            </div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="btn" id="retry-test">Retry Test</button>
            </div>
        </div>
    </div>

    <script>
        // Timer variables
        let timeLeft = 18 * 60; // 18 minutes in seconds
        let timerInterval;
        let currentModule = 1;
        
        // Score tracking
        let module1Score = 0;
        let module2Score = 0;
        let module1Submitted = false;
        let module2Submitted = false;
        
        // Sentence answers
        const sentenceAnswers = {
            21: "What is the water temperature like this time of year?",
            22: "Do you have a shopping list?",
            23: "What recipes will you learn?",
            24: "She wanted to know where she could buy a copy.",
            25: "I used the study guide that was provided by the professor it",
            26: "The tour guides who showed us around the old city were fantastic.",
            27: "Do you know if she will be moving to a different department?"
        };
        
        // DOM Elements
        const timerElement = document.getElementById('time');
        const module1Btn = document.getElementById('btn-module1');
        const module2Btn = document.getElementById('btn-module2');
        const module1Content = document.getElementById('module1');
        const module2Content = document.getElementById('module2');
        const submitModule1Btn = document.getElementById('submit-module1');
        const submitModule2Btn = document.getElementById('submit-module2');
        const resultsSection = document.getElementById('results');
        const finalScoreElement = document.getElementById('final-score');
        const scoreBreakdownElement = document.getElementById('score-breakdown');
        const feedbackElement = document.getElementById('feedback');
        const retryBtn = document.getElementById('retry-test');
        
        // Initialize the test
        function initTest() {
            startTimer();
            setupEventListeners();
            setupSentenceBuilding();
        }
        
        // Timer functions
        function startTimer() {
            clearInterval(timerInterval);
            updateTimerDisplay();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    if (currentModule === 1 && !module1Submitted) {
                        alert("Time's up for Module 1! Automatically submitting...");
                        submitModule1();
                    } else if (currentModule === 2 && !module2Submitted) {
                        alert("Time's up for Module 2! Automatically submitting...");
                        submitModule2();
                    }
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Change color when time is running low
            if (timeLeft < 300) { // Less than 5 minutes
                timerElement.parentElement.style.backgroundColor = '#e74c3c';
            } else if (timeLeft < 600) { // Less than 10 minutes
                timerElement.parentElement.style.backgroundColor = '#f39c12';
            }
        }
        
        function resetTimer() {
            timeLeft = 18 * 60;
            updateTimerDisplay();
            timerElement.parentElement.style.backgroundColor = '#2c3e50';
        }
        
        // Module switching
        function switchModule(moduleNumber) {
            currentModule = moduleNumber;
            
            // Update button states
            module1Btn.classList.toggle('active', moduleNumber === 1);
            module2Btn.classList.toggle('active', moduleNumber === 2);
            
            // Update content visibility
            module1Content.classList.toggle('active', moduleNumber === 1);
            module2Content.classList.toggle('active', moduleNumber === 2);
            
            // Reset timer when switching modules
            resetTimer();
            startTimer();
            
            // Disable module 1 button if already submitted
            if (module1Submitted) {
                module1Btn.disabled = true;
                module1Btn.style.opacity = '0.6';
            }
            
            // Show warning if trying to go back to module 1 after starting module 2
            if (moduleNumber === 1 && module2Submitted) {
                alert("You cannot return to Module 1 after starting Module 2.");
                switchModule(2);
                return;
            }
        }
        
        // Setup sentence building drag and drop
        function setupSentenceBuilding() {
            document.querySelectorAll('.word-option').forEach(word => {
                word.addEventListener('click', function() {
                    const wordBank = this.closest('.word-bank');
                    const sentenceArea = document.getElementById(`sentence-area-${wordBank.id.split('-')[2]}`);
                    
                    if (!this.classList.contains('used')) {
                        // Create a new word in sentence area
                        const newWord = this.cloneNode(true);
                        newWord.classList.add('used');
                        newWord.addEventListener('click', function() {
                            // Return word to bank
                            this.remove();
                            const originalWord = wordBank.querySelector(`.word-option[data-word="${this.dataset.word}"]`);
                            if (originalWord) {
                                originalWord.classList.remove('used');
                            }
                        });
                        
                        sentenceArea.appendChild(newWord);
                        this.classList.add('used');
                    }
                });
            });
        }
        
        // Clear sentence
        function clearSentence(questionNum) {
            const sentenceArea = document.getElementById(`sentence-area-${questionNum}`);
            const wordBank = document.getElementById(`word-bank-${questionNum}`);
            
            // Clear sentence area
            sentenceArea.innerHTML = '';
            
            // Reset all words in bank
            wordBank.querySelectorAll('.word-option').forEach(word => {
                word.classList.remove('used');
            });
        }
        
        // Check sentence answer
        function checkSentenceAnswer(questionNum) {
            const sentenceArea = document.getElementById(`sentence-area-${questionNum}`);
            const words = Array.from(sentenceArea.querySelectorAll('.word-option'))
                .map(word => word.dataset.word)
                .join(' ');
            
            const correctAnswer = sentenceAnswers[questionNum].toLowerCase().replace(/[.,?]/g, '');
            const userAnswer = words.toLowerCase();
            
            // Simple check - could be improved with more sophisticated comparison
            return userAnswer === correctAnswer;
        }
        
        // Setup event listeners
        function setupEventListeners() {
            // Module selection
            module1Btn.addEventListener('click', () => switchModule(1));
            module2Btn.addEventListener('click', () => {
                if (!module1Submitted) {
                    if (confirm("You haven't submitted Module 1 yet. Do you want to submit it and proceed to Module 2?")) {
                        submitModule1();
                        switchModule(2);
                    }
                } else {
                    switchModule(2);
                }
            });
            
            // Submit buttons
            submitModule1Btn.addEventListener('click', submitModule1);
            submitModule2Btn.addEventListener('click', submitModule2);
            
            // Retry button
            retryBtn.addEventListener('click', resetTest);
            
            // Multiple choice questions
            document.querySelectorAll('.option').forEach(option => {
                option.addEventListener('click', function() {
                    const question = this.closest('.question');
                    const options = question.querySelectorAll('.option');
                    
                    // Remove selected class from all options in this question
                    options.forEach(opt => opt.classList.remove('selected'));
                    
                    // Add selected class to clicked option
                    this.classList.add('selected');
                    
                    // Store the selected value
                    this.closest('.question').dataset.selected = this.dataset.value;
                });
            });
            
            // C-test input handling
            document.querySelectorAll('.c-blank input').forEach(input => {
                input.addEventListener('input', function() {
                    this.value = this.value.toLowerCase();
                    
                    // Auto-advance to next input
                    if (this.value.length >= this.maxLength) {
                        const nextInput = this.parentElement.nextElementSibling?.querySelector('input');
                        if (nextInput) {
                            nextInput.focus();
                        }
                    }
                });
                
                // Allow navigation with arrow keys
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'ArrowLeft') {
                        const prevInput = this.parentElement.previousElementSibling?.querySelector('input');
                        if (prevInput) {
                            prevInput.focus();
                        }
                    } else if (e.key === 'ArrowRight') {
                        const nextInput = this.parentElement.nextElementSibling?.querySelector('input');
                        if (nextInput) {
                            nextInput.focus();
                        }
                    }
                });
            });
        }
        
        // Submit Module 1
        function submitModule1() {
            module1Score = calculateModuleScore(1);
            module1Submitted = true;
            
            // Disable inputs in module 1
            disableModuleInputs(1);
            
            // Show results for module 1
            showModuleResults(1, module1Score);
            
            // Enable module 2 button
            module2Btn.disabled = false;
            module2Btn.style.opacity = '1';
            module2Btn.style.cursor = 'pointer';
            
            // Switch to module 2 automatically
            switchModule(2);
        }
        
        // Submit Module 2
        function submitModule2() {
            module2Score = calculateModuleScore(2);
            module2Submitted = true;
            
            // Disable inputs in module 2
            disableModuleInputs(2);
            
            // Show final results
            showFinalResults();
        }
        
        // Calculate score for a module
        function calculateModuleScore(moduleNumber) {
            let score = 0;
            const moduleElement = document.getElementById(`module${moduleNumber}`);
            
            // Calculate C-test score (questions 1-10)
            const cBlanks = moduleElement.querySelectorAll('.c-blank');
            cBlanks.forEach(blank => {
                const input = blank.querySelector('input');
                const answer = blank.dataset.answer;
                
                if (input.value.toLowerCase() === answer.toLowerCase()) {
                    score++;
                    blank.classList.add('correct');
                } else if (input.value.trim() !== '') {
                    blank.classList.add('incorrect');
                }
            });
            
            // Calculate sentence building score (questions 21-25 for module 1, 21-22 for module 2)
            if (moduleNumber === 1) {
                for (let i = 21; i <= 25; i++) {
                    if (checkSentenceAnswer(i)) {
                        score++;
                    }
                }
            } else {
                for (let i = 26; i <= 27; i++) {
                    if (checkSentenceAnswer(i)) {
                        score++;
                    }
                }
            }
            
            // Calculate multiple choice score
            const questions = moduleElement.querySelectorAll('.question.mcq');
            questions.forEach((question, index) => {
                const selectedValue = question.dataset.selected;
                const correctValue = question.dataset.correct;
                
                if (selectedValue === correctValue) {
                    score++;
                    
                    // Mark correct answer
                    question.querySelectorAll('.option').forEach(option => {
                        if (option.dataset.value === correctValue) {
                            option.classList.add('correct');
                        }
                    });
                } else if (selectedValue) {
                    // Mark incorrect answer
                    question.querySelectorAll('.option').forEach(option => {
                        if (option.dataset.value === selectedValue) {
                            option.classList.add('incorrect');
                        }
                        if (option.dataset.value === correctValue) {
                            option.classList.add('correct');
                        }
                    });
                }
            });
            
            return score;
        }
        
        // Disable inputs in a module
        function disableModuleInputs(moduleNumber) {
            const moduleElement = document.getElementById(`module${moduleNumber}`);
            
            // Disable C-test inputs
            moduleElement.querySelectorAll('.c-blank input').forEach(input => {
                input.disabled = true;
            });
            
            // Disable MCQ options
            moduleElement.querySelectorAll('.option').forEach(option => {
                option.style.pointerEvents = 'none';
            });
            
            // Disable sentence building
            moduleElement.querySelectorAll('.word-option').forEach(word => {
                word.style.pointerEvents = 'none';
            });
            
            moduleElement.querySelectorAll('.btn-clear').forEach(btn => {
                btn.disabled = true;
                btn.style.opacity = '0.6';
            });
        }
        
        // Show module results
        function showModuleResults(moduleNumber, score) {
            alert(`Module ${moduleNumber} submitted!\nYour score: ${score}/20`);
        }
        
        // Show final results
        function showFinalResults() {
            const totalScore = module1Score + module2Score;
            const totalQuestions = 35; // 10 c-test + 5 sentence + 2 MCQ in each module
            const percentage = (totalScore / totalQuestions) * 100;
            
            // Update final score
            finalScoreElement.textContent = `Score: ${totalScore}/${totalQuestions} (${percentage.toFixed(1)}%)`;
            
            // Update score breakdown
            scoreBreakdownElement.innerHTML = `
                <div class="score-item">
                    <div>Module 1</div>
                    <div class="${module1Score >= 10 ? 'correct-answer' : 'incorrect-answer'}">${module1Score}/17</div>
                </div>
                <div class="score-item">
                    <div>Module 2</div>
                    <div class="${module2Score >= 10 ? 'correct-answer' : 'incorrect-answer'}">${module2Score}/18</div>
                </div>
                <div class="score-item">
                    <div>C-Test (1-10 each)</div>
                    <div>${(module1Score + module2Score - 10)}/20</div>
                </div>
                <div class="score-item">
                    <div>Sentence Building</div>
                    <div>7/7</div>
                </div>
                <div class="score-item">
                    <div>Reading Comprehension</div>
                    <div>4/8</div>
                </div>
            `;
            
            // Provide feedback
            let feedback = '';
            if (percentage >= 85) {
                feedback = '<strong>Excellent!</strong> You have a strong command of English reading and grammar.';
            } else if (percentage >= 70) {
                feedback = '<strong>Good job!</strong> Your English skills are solid, but there\'s room for improvement.';
            } else if (percentage >= 50) {
                feedback = '<strong>Fair.</strong> You should focus more on vocabulary, grammar, and reading practice.';
            } else {
                feedback = '<strong>Needs improvement.</strong> Consider practicing with simpler texts and building vocabulary.';
            }
            
            feedback += '<br><br>Remember: TOEFL tests both vocabulary knowledge and the ability to understand main ideas, details, and sentence structure in English.';
            
            feedbackElement.innerHTML = feedback;
            
            // Show results section
            resultsSection.classList.add('active');
            
            // Stop timer
            clearInterval(timerInterval);
        }
        
        // Reset the entire test
        function resetTest() {
            // Reset scores
            module1Score = 0;
            module2Score = 0;
            module1Submitted = false;
            module2Submitted = false;
            
            // Clear all C-test inputs
            document.querySelectorAll('.c-blank input').forEach(input => {
                input.value = '';
                input.disabled = false;
                input.parentElement.classList.remove('correct', 'incorrect');
            });
            
            // Clear MCQ selections
            document.querySelectorAll('.question').forEach(question => {
                delete question.dataset.selected;
                question.querySelectorAll('.option').forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                    option.style.pointerEvents = 'auto';
                });
            });
            
            // Clear sentence building
            for (let i = 21; i <= 27; i++) {
                clearSentence(i);
                const wordBank = document.getElementById(`word-bank-${i}`);
                if (wordBank) {
                    wordBank.querySelectorAll('.word-option').forEach(word => {
                        word.style.pointerEvents = 'auto';
                    });
                }
                const clearBtn = document.querySelector(`button[onclick="clearSentence(${i})"]`);
                if (clearBtn) {
                    clearBtn.disabled = false;
                    clearBtn.style.opacity = '1';
                }
            }
            
            // Reset UI
            module1Btn.disabled = false;
            module1Btn.style.opacity = '1';
            module2Btn.disabled = false;
            module2Btn.style.opacity = '1';
            
            // Hide results
            resultsSection.classList.remove('active');
            
            // Switch back to module 1
            switchModule(1);
        }
        
        // Start the test when page loads
        window.addEventListener('DOMContentLoaded', initTest);
    </script>
</body>
</html>
